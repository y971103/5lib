<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 게시판 처리 SQL -->

<mapper namespace="global.sesoc.library.dao.MypageMapper">
	
	<!-- 내 서재에 책 코멘트 등록 -->
	<insert id="insertComments" parameterType="comments">
		insert into comments (
			commentnum
			, id
			, content
			, booknum
		)
		values (
			comments_seq.nextval				
			, #{commentnum}
			, #{id}
			, #{content}
			, #{booknum}
		)
	</insert>
	
	<!-- 등록한 내 서재 책 코멘트 삭제 -->
	<delete id="deleteComments" parameterType="comments">
		delete
		from
			comments
		where
			commentnum = #{commentnum}
			and id = #{id}
	</delete>
	
	<!-- 등록한 내 서재 책 코멘트 내용 수정 -->
	<update id="updateComments" parameterType="comments">
		update
			comments
		set
			content = #{content}
		where
			commentnum = #{commentnum}
			and id = #{id}
	</update>
	

	
	<!-- 독서시간 재기 -->
	<insert id="countTime" parameterType="habit">
    insert
    into
        habit
        (
            id
            , time
        )
    values
        (
            #{id}
            , #{time}
        )
</insert>

	<!-- id별 총 독서시간 -->
   <select id="selectTime" parameterType="string" resultType="habit">
    select
      sum(time) as time,
	  (select day from (select to_char(inputdate, 'day') as day, count(to_char(inputdate, 'day')) as ct
	  from habit where id=#{id} group by to_char(inputdate, 'day') 
	  order by count(to_char(inputdate, 'day')) desc) where rownum=1) as inputdate
   from
      habit
        where id = #{id}
    group by id
   </select>
	
		<!-- 위시리스트 내용 목록 -->
	<select id="listshelf" parameterType="string" resultType="shelf">
		select 
			isbn
			, authors
			, title
			, to_char(inputdate, 'YYYY-MM-DD') inputdate
			, thumbnail
		from
			shelf
		where
			id = #{id}
		order by 
			title
	</select>
</mapper>

	
	

<!-- 
<mapper namespace="global.sesoc.library.dao.MypageMapper">
	<insert id="insertShelf" parameterType="shelf">
	insert
	into
		habit
		(
			inputdate 
			, id
			, isbn
			)
		values
			(
			#{inputdate} 
			, #{id}
			, #{isvn}
			)
	</insert>

</mapper> -->